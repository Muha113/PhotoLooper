@{
    ViewData["Title"] = "Photo";
    Layout = "_Layout";
}

@model PostCollector

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <meta id="viewport" name="viewport" content="width=320; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" />
    <style>
        /*#testim {
            top: 100px; 
            left: 100px; 
            bottom: 0; right: 0;
        }*/
    </style>
</head>

<body>
    @*<section class="main clearfix">*@
<form asp-action="TypeComment" asp-controller="Home" method="post">
    <div class="main clearfix position-relative">
        <div class="work">
            <img src=@Model.Post.Path class="media" alt="" />
            @*<img src="~/images/work1.jpg" class="media" alt="" />*@
            <div class="caption">
                <div class="work_title">
                    <h1></h1>
                </div>
            </div>
        </div>
        <div class="row-space">
            <div class="wrap-input100 position-relative">
                <input type="text" size="40" name="com" id="message"/>
                <input type="hidden" name="pId" value=@Model.Post.Id />
                <input type="submit" id="sendBtn" icon="~/images/send.ico" />
            </div>
            @if (Model.Comments.Count != 0)
            {
                @foreach (var x in Model.Comments)
                {
                    <div>
                        <a href="~/Home/Profile?id=@x.UserId">@ViewBag.context.GetUserCollector(x.UserId).User.NickName : </a>
                        <a>@x.comment</a>
                    </div>
                }
            }
            <div>
                <span id="commentUser"></span>
                <a id="commentPost"></a>
            </div>
            @*<script src="~/js/signalr.min.js"></script>
            <script>
                let hubUrl = 'https://localhost:5001/Home/Photo?selected=@Model.Post.Id';
                const hubConnection = new signalR.HubConnectionBuilder()
                    .withUrl(hubUrl)
                    .configureLogging(signalR.LogLevel.Information)
                    .build();

                hubConnection.on("Send", function (data) {

                    let elem = document.createElement("p");
                    elem.appendChild(document.createTextNode(data));
                    let firstElem = document.getElementById("commentPost").firstChild;
                    document.getElementById("commentPost").insertBefore(elem, firstElem);

                });

                document.getElementById("sendBtn").addEventListener("click", function (e) {
                    let message = document.getElementById("message").value;
                    hubConnection.invoke("Send", message);
                });

                hubConnection.start();
            </script>
            <span>@Model.Post.DateTime</span>*@
        </div>
    </div>
</form>
    @*</section>*@<!-- end main -->
</body>
</html>

